{
    "collab_server" : "",
    "contents" : "#' Read OECD GDP / ratio PPP2MER\n#' \n#' Read-in GDP or ratio PPP2MER data xlsx file from OECD as magclass object\n#' \n#' \n#' @param subtype data subtype. Either \"gdp\" or \"ratioPM\"\n#' @return magpie object of the GDP data\n#' @author Lavinia Baumstark\n#' @seealso \\code{\\link{readSource}}\n#' @examples\n#' \n#' \\dontrun{ \n#' a <- readSource(\"OECD\",\"gdp\")\n#' a <- readSource(\"OECD\",\"ratioPM\")\n#' \n#' }\n#' \nreadOECD <- function(subtype) {\n  files <- c(gdp=\"OECD_v9_25-3-13-3.xlsx\",\n             ratioPM=\"OECD-WB_PPP-MER2005_conversion_rates.xlsx\")\n  \n  file <- toolSubtypeSelect(subtype,files)\n  \n  data <- as.data.frame(read_excel(file))\n  \n  if(subtype==\"gdp\") {\n    data <- data[data$Variable==\"GDP|PPP\",]\n    data <- data[,c(-1,-4,-5)]  # should be done better?\n    x <- as.magpie(data)\n    getNames(x) <- paste(\"gdp_\",gsub(\"_v[[:alnum:],[:punct:]]*\",\"\",getNames(x)),sep=\"\")\n  } else if(subtype==\"ratioPM\") {\n    data <- data[-1,c(1,2)]\n    data[,2] <- as.numeric(data[,2])\n    colnames(data) <- c(\"Region\",\"y2005\") #automated?\n    x <- as.magpie(data)    \n  }  \n    \n  return(x)\n}  \n",
    "created" : 1508325140374.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "884462826",
    "id" : "11D31F25",
    "lastKnownWriteTime" : 1489653951,
    "last_content_update" : 1489653951,
    "path" : "~/Documents/work/libraries/moinput/R/readOECD.R",
    "project_path" : "R/readOECD.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}